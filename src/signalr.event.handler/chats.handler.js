require("dotenv").config();const{SESSION_ID:SESSION_ID}=process.env,{getMessageByJid:getMessageByJid,getLastMessages:getLastMessages}=require("../db.repository/messages.repository"),onArchiveChatHandler=async(e,s)=>{const a=JSON.parse(e),{sessionId:t,phoneNumber:o}=a;if(t===SESSION_ID)if(o)try{const e=await getMessageByJid(o),a=JSON.parse(e);await s.chatModify({archive:!0,lastMessages:[a]},o)}catch(e){console.log(`ex: ${e}`)}else try{const e=await getLastMessages();for(const a of e){const e=JSON.parse(a.message);e.key.fromMe||await s.chatModify({archive:!0,lastMessages:[e]},a.jid)}}catch(e){console.log(`ex: ${e}`)}};module.exports={onArchiveChatHandler:onArchiveChatHandler};