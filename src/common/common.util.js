const vcardToJSON=e=>{const t={},a=e.split("\n");for(const e of a){const[a,i]=e.split(":");"BEGIN"!==a&&"END"!==a&&"PHOTO;BASE64"!==a&&("VERSION"===a&&(t.version=i),"N"===a&&(t.n=i),"FN"===a&&(t.fn=i),"ORG"===a&&(t.org=i),"TITLE"===a&&(t.title=i),a.toLowerCase().indexOf("waid")>=0&&(t.waid=i),"TEL;type=Work"===a&&(t.telWork=i),"TEL;type=Home"===a&&(t.telHome=i),"EMAIL;TYPE=Work"===a&&(t.emailWork=i),"EMAIL;TYPE=Home"===a&&(t.emailHome=i),a.indexOf("ADR;type=Work")>=0&&(t.adrWork=i),a.indexOf("ADR;type=Home")>=0&&(t.adrHome=i))}return t},keyExist=(e,t)=>{try{if(e[t])return e[t];for(const a in e)if("object"==typeof e[a]){if(keyExist(e[a],t))return!0}}catch(e){}return!1},findVal=(e,t)=>{try{if(e[t])return e[t];for(const a in e)if("object"==typeof e[a]){const i=findVal(e[a],t);if(i)return i}}catch(e){}},isUrl=e=>/^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]*)\S*$/.test(e),isImage=e=>"image"===e.split("/")[0],waitFor=e=>new Promise(t=>setTimeout(t,e)),asyncForEach=async(e,t)=>{for(let a=0;a<e.length;a++)await t(e[a],a,e)},msgContent=(e,t)=>{let a=void 0;try{switch(e){case"chat":if(!(a=findVal(t,"conversation"))){const e=findVal(t,"extendedTextMessage");e&&(a=e.text)}break;case"image":a=findVal(t,"caption");break;case"document":a=findVal(t,"title");break;case"location":a=findVal(t,"name");break;case"button":if(!(a=findVal(t,"caption"))){(keyExist(t,"urlButton")||keyExist(t,"callButton")||keyExist(t,"quickReplyButton"))&&(a=findVal(t,"hydratedContentText"))}break;case"buttons_response":a=findVal(t,"selectedDisplayText");break;case"list":a=findVal(t,"description");break;case"list_response":a=findVal(t,"title");break;case"vcard":case"multi_vcard":a=findVal(t,"displayName");break;case"video":a=findVal(t,"caption")}}catch(e){}return a},validateJid=e=>{const t=e.split("@"),a=t[0],i=t[1],n=a.indexOf(":")>=0?a.split(":")[0]:a;return waId=`${n}@${i}`,waId};module.exports={vcardToJSON:vcardToJSON,keyExist:keyExist,findVal:findVal,isUrl:isUrl,isImage:isImage,msgContent:msgContent,waitFor:waitFor,asyncForEach:asyncForEach,validateJid:validateJid};