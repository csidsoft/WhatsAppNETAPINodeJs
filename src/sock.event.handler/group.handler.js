require("dotenv").config();const{SESSION_ID:SESSION_ID}=process.env,{getContactById:getContactById}=require("../db.repository/contacts.repository"),{signalRClient:signalRClient,serverHub:serverHub}=require("../signalr/signalr.util"),groupsParticipantsUpdate=async e=>{const t="add"===e.action?"GroupJoin":"GroupLeave";let i=void 0;try{i=await getContactById(e.id)}catch(e){console.log(`ex: ${e}`)}let n={id:i.id?i.id:"",name:i.name?i.name:"",recipients:void 0},o=[];for(const t of e.participants){let e=void 0;try{e=await getContactById(t)}catch(e){console.log(`ex: ${e}`)}let i=void 0;i=e?{id:e.id?e.id:"",name:e.name?e.name:"",shortName:"",pushname:e.pushName?e.pushName:""}:{id:t,name:"",shortName:"",pushname:""},o.push(i)}n.recipients=o,signalRClient.connection.hub.invoke(serverHub,t,JSON.stringify({groupNotification:n,sessionId:SESSION_ID}))};module.exports=groupsParticipantsUpdate;